<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.mt.mms.topContr.mapper.TopContrMapper">
    <select id="getTopContrs" resultType="org.mt.mms.topContr.vo.TopContrVO">

        SELECT
            TOP_CONTR_ID,
            TOP_CONTR_NM,
            TOP_CONTR_DIV,
            CLIENT_COMP,
            TOP_CONTR_DATE,
            CONTR_ST_DATE,
            CONTR_END_DATE,
            PROD_NM,
            CONTR_AMOUNT,
            DELIVERY_DEADLINE,
            DEMAND_INST_NM,
            REGIST_USER_NAME,
            REGIST_DATE,
            DEL_YN,
            TOP_CONTR_FILE_ID
        FROM
            TOP_CONTR
        WHERE DEL_YN = 'N'
    </select>

    <insert id="newTopContr" parameterType="org.mt.mms.topContr.vo.TopContrVO">
        INSERT INTO PROJECT
        (
            PROJECT_ID,
            PROJECT_NAME,
            PROJECT_ST_DATE,
            PROJECT_END_DATE,
            PROJECT_STATUS,
            CUSTOMER,
            REMARK,
            REGIST_USER_NAME,
            REGIST_DATE
        )
        VALUES
        (
            CONCAT('HLOTP',NEXTVAL(HLOT_SEQ)),
            #{projectName},
            #{projectStDate},
            #{projectEndDate},
            #{projectStatus},
            #{customer},
            #{remark},
            '최성주',
            sysdate()
        )
    </insert>

    <select id="one" resultType="org.mt.mms.topContr.vo.TopContrVO" parameterType="string">
        SELECT
            TOP_CONTR_ID,
            TOP_CONTR_NM,
            TOP_CONTR_DIV,
            CLIENT_COMP,
            TOP_CONTR_DATE,
            CONTR_ST_DATE,
            CONTR_END_DATE,
            PROD_NM,
            CONTR_AMOUNT,
            DELIVERY_DEADLINE,
            DEMAND_INST_NM,
            REGIST_USER_NAME,
            REGIST_DATE,
            DEL_YN,
            TOP_CONTR_FILE_ID
        FROM
            TOP_CONTR
        WHERE TOP_CONTR_ID  = #{projectId}
    </select>

    <update id="updateTopContr" parameterType="org.mt.mms.topContr.vo.TopContrVO">
        UPDATE PROJECT
        SET
        PROJECT_NAME 		= #{projectName},
        PROJECT_ST_DATE 	= #{projectStDate},
        PROJECT_END_DATE	= #{projectEndDate},
        PROJECT_STATUS 		= #{projectStatus},
        CUSTOMER 			= #{customer},
        REMARK 				= #{remark},
        MODIFY_DATE = SYSDATE(),
        MODIFY_USER_NAME = '최성주'
        WHERE
        PROJECT_ID = #{projectId}
    </update>

    <update id="deleteTopContr" parameterType="java.util.ArrayList">

            UPDATE PROJECT SET
            DEL_YN = 'Y'
            WHERE
            PROJECT_ID IN
        <foreach collection="deldata" open="(" close=")" separator="," item="item">
            #{item}
        </foreach>
    </update>

</mapper>
